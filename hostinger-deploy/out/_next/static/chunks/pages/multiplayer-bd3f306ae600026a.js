(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[271],{683:function(e,a,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/multiplayer",function(){return r(5873)}])},5873:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return S}});var t=r(4246),o=r(8038),n=r.n(o),s=r(21),i=r(7378),l=r(2984);let c={roomCode:"",playerNickname:"",lobbyData:null,isLoading:!1,error:"",isConnected:!1,currentScreen:"lobby"},d={SET_ROOM_CODE:"SET_ROOM_CODE",SET_PLAYER_NICKNAME:"SET_PLAYER_NICKNAME",SET_LOBBY_DATA:"SET_LOBBY_DATA",SET_LOADING:"SET_LOADING",SET_ERROR:"SET_ERROR",SET_CONNECTED:"SET_CONNECTED",SET_CURRENT_SCREEN:"SET_CURRENT_SCREEN",RESET:"RESET"};function u(e,a){switch(a.type){case d.SET_ROOM_CODE:return{...e,roomCode:a.payload};case d.SET_PLAYER_NICKNAME:return{...e,playerNickname:a.payload};case d.SET_LOBBY_DATA:return{...e,lobbyData:a.payload};case d.SET_LOADING:return{...e,isLoading:a.payload};case d.SET_ERROR:return{...e,error:a.payload};case d.SET_CONNECTED:return{...e,isConnected:a.payload};case d.SET_CURRENT_SCREEN:return{...e,currentScreen:a.payload};case d.RESET:return c;default:return e}}let p=(0,i.createContext)();function m(e){let{children:a}=e,[r,o]=(0,i.useReducer)(u,c);return(0,i.useEffect)(()=>{if(!r.roomCode||!r.isConnected)return;let e=!0,a=0,t=async()=>{if(e)try{let t=await (0,l.Nv)("/api/lobby?roomCode=".concat(r.roomCode),{method:"GET",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!e)return;if(t.ok){let n=await t.json();e&&(n.roomNotFound?++a>=5&&o({type:d.SET_ERROR,payload:"Conex\xe3o perdida com a sala"}):(o({type:d.SET_LOBBY_DATA,payload:n}),a=0,r.error&&o({type:d.SET_ERROR,payload:""})))}else++a>=10&&e&&o({type:d.SET_ERROR,payload:"Problemas de conex\xe3o com o servidor"})}catch(r){++a>=5&&e&&o({type:d.SET_ERROR,payload:"Problemas de conex\xe3o"})}},n=setTimeout(t,500),s=setInterval(t,4e3);return()=>{e=!1,clearTimeout(n),clearInterval(s)}},[r.roomCode,r.isConnected]),(0,t.jsx)(p.Provider,{value:{state:r,actions:{setRoomCode:e=>o({type:d.SET_ROOM_CODE,payload:e}),setPlayerNickname:e=>o({type:d.SET_PLAYER_NICKNAME,payload:e}),setLobbyData:e=>o({type:d.SET_LOBBY_DATA,payload:e}),setLoading:e=>o({type:d.SET_LOADING,payload:e}),setError:e=>o({type:d.SET_ERROR,payload:e}),setConnected:e=>o({type:d.SET_CONNECTED,payload:e}),setCurrentScreen:e=>o({type:d.SET_CURRENT_SCREEN,payload:e}),reset:()=>o({type:d.RESET}),createRoom:async e=>{o({type:d.SET_LOADING,payload:!0}),o({type:d.SET_ERROR,payload:""});try{let a=await (0,l.Nv)("/api/lobby",{method:"POST",body:JSON.stringify({nickname:e})});if(a.ok){let r=await a.json();o({type:d.SET_ROOM_CODE,payload:r.roomCode}),o({type:d.SET_PLAYER_NICKNAME,payload:e}),o({type:d.SET_CONNECTED,payload:!0});let t=await (0,l.Nv)("/api/lobby?roomCode=".concat(r.roomCode));if(t.ok){let e=await t.json();o({type:d.SET_LOBBY_DATA,payload:e})}return r}{let e=await a.json();throw o({type:d.SET_ERROR,payload:e.error||"Erro ao criar sala"}),Error(e.error)}}catch(e){throw o({type:d.SET_ERROR,payload:"Erro de conex\xe3o"}),e}finally{o({type:d.SET_LOADING,payload:!1})}},joinRoom:async(e,a)=>{o({type:d.SET_LOADING,payload:!0}),o({type:d.SET_ERROR,payload:""});try{let r=await (0,l.Nv)("/api/lobby",{method:"PUT",body:JSON.stringify({roomCode:e,nickname:a})});if(r.ok){let t=await r.json();return o({type:d.SET_ROOM_CODE,payload:e}),o({type:d.SET_PLAYER_NICKNAME,payload:a}),o({type:d.SET_LOBBY_DATA,payload:t}),o({type:d.SET_CONNECTED,payload:!0}),t}{let e=await r.json();throw o({type:d.SET_ERROR,payload:e.error||"Erro ao entrar na sala"}),Error(e.error)}}catch(e){throw o({type:d.SET_ERROR,payload:"Erro de conex\xe3o"}),e}finally{o({type:d.SET_LOADING,payload:!1})}},startGame:async()=>{if(r.roomCode){o({type:d.SET_LOADING,payload:!0}),o({type:d.SET_ERROR,payload:""});try{let e=await (0,l.Nv)("/api/lobby",{method:"PATCH",body:JSON.stringify({roomCode:r.roomCode,action:"start"})});if(e.ok){let a=await e.json();return o({type:d.SET_LOBBY_DATA,payload:a}),o({type:d.SET_CURRENT_SCREEN,payload:"game"}),a}{let a=await e.json();throw o({type:d.SET_ERROR,payload:a.error||"Erro ao iniciar jogo"}),Error(a.error)}}catch(e){throw o({type:d.SET_ERROR,payload:"Erro de conex\xe3o"}),e}finally{o({type:d.SET_LOADING,payload:!1})}}},makeGuess:async e=>{if(!r.roomCode||!r.playerNickname)return{success:!1,error:"Dados inv\xe1lidos"};try{let a=await (0,l.Nv)("/api/lobby",{method:"PATCH",body:JSON.stringify({roomCode:r.roomCode,action:"guess",nickname:r.playerNickname,guess:e})}),t=await a.json();if(a.ok)return t.lobbyData&&o({type:d.SET_LOBBY_DATA,payload:t.lobbyData}),{success:!0,correct:t.correct,gameCorrect:t.gameCorrect,winner:t.winner,attempts:t.attempts,tooLate:t.tooLate,message:t.message};return{success:!1,error:t.error}}catch(e){return{success:!1,error:"Erro de conex\xe3o"}}},nextRound:async()=>{if(!r.roomCode)return{success:!1,error:"Dados inv\xe1lidos"};try{let e=await (0,l.Nv)("/api/lobby",{method:"PATCH",body:JSON.stringify({roomCode:r.roomCode,action:"nextRound",nickname:r.playerNickname})}),a=await e.json();if(e.ok)return a.lobbyData&&o({type:d.SET_LOBBY_DATA,payload:a.lobbyData}),{success:!0};return o({type:d.SET_ERROR,payload:a.error||"Erro ao avan\xe7ar rodada"}),{success:!1,error:a.error}}catch(e){return o({type:d.SET_ERROR,payload:"Erro de conex\xe3o"}),{success:!1,error:"Erro de conex\xe3o"}}},skipRound:async()=>{if(!r.roomCode||!r.playerNickname)return{success:!1,error:"Dados inv\xe1lidos"};try{let e=await (0,l.Nv)("/api/lobby",{method:"PATCH",body:JSON.stringify({roomCode:r.roomCode,action:"skip",nickname:r.playerNickname})}),a=await e.json();if(e.ok)return a.lobbyData&&o({type:d.SET_LOBBY_DATA,payload:a.lobbyData}),{success:!0};return o({type:d.SET_ERROR,payload:a.error||"Erro ao pular rodada"}),{success:!1,error:a.error}}catch(e){return o({type:d.SET_ERROR,payload:"Erro de conex\xe3o"}),{success:!1,error:"Erro de conex\xe3o"}}},resetGame:async()=>{if(!r.roomCode||!r.playerNickname)return{success:!1,error:"Dados inv\xe1lidos"};o({type:d.SET_LOADING,payload:!0}),o({type:d.SET_ERROR,payload:""});try{let e=await (0,l.Nv)("/api/lobby",{method:"PATCH",body:JSON.stringify({roomCode:r.roomCode,action:"reset",nickname:r.playerNickname})}),a=await e.json();if(e.ok)return a.lobbyData&&o({type:d.SET_LOBBY_DATA,payload:a.lobbyData}),o({type:d.SET_CURRENT_SCREEN,payload:"lobby"}),{success:!0};return o({type:d.SET_ERROR,payload:a.error||"Erro ao resetar jogo"}),{success:!1,error:a.error}}catch(e){return o({type:d.SET_ERROR,payload:"Erro de conex\xe3o"}),{success:!1,error:"Erro de conex\xe3o"}}finally{o({type:d.SET_LOADING,payload:!1})}}}},children:a})}function y(){let e=(0,i.useContext)(p);if(!e)throw Error("useMultiplayerContext deve ser usado dentro de MultiplayerProvider");return e}var g=r(7696),x=r.n(g),h=e=>{var a,r,o;let{onGameStart:n}=e,{t:l,isClient:c}=(0,s.Z)(),{state:d,actions:u}=y(),{roomCode:p,playerNickname:m,lobbyData:g,isLoading:h,error:_}=d,[v,E]=(0,i.useState)({nickname:"",roomCode:""}),[b,f]=(0,i.useState)("menu");(0,i.useEffect)(()=>{g&&g.gameStarted&&"waiting"===b&&n()},[null==g?void 0:g.gameStarted,n,b]);let j=e=>{let{name:a,value:r}=e.target;E(e=>({...e,[a]:r}))},N=async e=>{if(e.preventDefault(),!v.nickname.trim()){u.setError(c?l("nickname_required"):"Nickname \xe9 obrigat\xf3rio"),setTimeout(()=>u.setError(""),3e3);return}try{await u.createRoom(v.nickname.trim()),f("waiting"),u.setError("")}catch(e){setTimeout(()=>u.setError(""),5e3)}},S=async e=>{if(e.preventDefault(),!v.nickname.trim()){u.setError(c?l("nickname_required"):"Nickname \xe9 obrigat\xf3rio"),setTimeout(()=>u.setError(""),3e3);return}if(!v.roomCode.trim()){u.setError(c?l("room_code_required"):"C\xf3digo da sala \xe9 obrigat\xf3rio"),setTimeout(()=>u.setError(""),3e3);return}try{await u.joinRoom(v.roomCode.trim().toUpperCase(),v.nickname.trim()),f("waiting"),u.setError("")}catch(e){setTimeout(()=>u.setError(""),5e3)}},C=async()=>{if(!h)try{await u.startGame(),n()}catch(e){}},T=async()=>{u.reset(),f("menu"),E({nickname:"",roomCode:""})},R=(null==g?void 0:g.host)===m,k=((null==g?void 0:null===(a=g.players)||void 0===a?void 0:a.length)||0)>=2;return"menu"===b?(0,t.jsx)("div",{className:x().container,children:(0,t.jsx)("div",{className:x().content,children:(0,t.jsxs)("div",{className:x().lobbyContainer,children:[(0,t.jsx)("h1",{className:x().title,children:c?l("multiplayer"):"Multiplayer"}),(0,t.jsxs)("div",{className:x().buttonGroup,children:[(0,t.jsx)("button",{className:x().primaryButton,onClick:()=>f("create"),disabled:h,children:c?l("create_room"):"Criar Sala"}),(0,t.jsx)("button",{className:x().secondaryButton,onClick:()=>f("join"),disabled:h,children:c?l("join_room"):"Entrar na Sala"})]}),_&&(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageError),children:_})]})})}):"create"===b?(0,t.jsx)("div",{className:x().container,children:(0,t.jsx)("div",{className:x().content,children:(0,t.jsxs)("div",{className:x().lobbyContainer,children:[(0,t.jsx)("h1",{className:x().title,children:c?l("create_room"):"Criar Sala"}),(0,t.jsxs)("form",{onSubmit:N,className:x().form,children:[(0,t.jsxs)("div",{className:x().inputGroup,children:[(0,t.jsx)("label",{className:x().label,children:c?l("nickname"):"Nickname"}),(0,t.jsx)("input",{type:"text",name:"nickname",value:v.nickname,onChange:j,placeholder:c?l("nickname"):"Seu nickname",className:x().input,maxLength:20,required:!0})]}),(0,t.jsxs)("div",{className:x().buttonGroup,children:[(0,t.jsx)("button",{type:"button",className:x().secondaryButton,onClick:()=>f("menu"),disabled:h,children:"Voltar"}),(0,t.jsx)("button",{type:"submit",className:x().primaryButton,disabled:h||!v.nickname.trim(),children:h?c?l("creating_room"):"Criando sala...":c?l("create_room"):"Criar Sala"})]})]}),_&&(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageError),children:_})]})})}):"join"===b?(0,t.jsx)("div",{className:x().container,children:(0,t.jsx)("div",{className:x().content,children:(0,t.jsxs)("div",{className:x().lobbyContainer,children:[(0,t.jsx)("h1",{className:x().title,children:c?l("join_room"):"Entrar na Sala"}),(0,t.jsxs)("form",{onSubmit:S,className:x().form,children:[(0,t.jsxs)("div",{className:x().inputGroup,children:[(0,t.jsx)("label",{className:x().label,children:c?l("nickname"):"Nickname"}),(0,t.jsx)("input",{type:"text",name:"nickname",value:v.nickname,onChange:j,placeholder:c?l("nickname"):"Seu nickname",className:x().input,maxLength:20,required:!0})]}),(0,t.jsxs)("div",{className:x().inputGroup,children:[(0,t.jsx)("label",{className:x().label,children:c?l("room_code"):"C\xf3digo da Sala"}),(0,t.jsx)("input",{type:"text",name:"roomCode",value:v.roomCode,onChange:j,placeholder:"ABC123",className:x().input,maxLength:6,style:{textTransform:"uppercase"},required:!0})]}),(0,t.jsxs)("div",{className:x().buttonGroup,children:[(0,t.jsx)("button",{type:"button",className:x().secondaryButton,onClick:()=>f("menu"),disabled:h,children:"Voltar"}),(0,t.jsx)("button",{type:"submit",className:x().primaryButton,disabled:h||!v.nickname.trim()||!v.roomCode.trim(),children:h?c?l("joining_room"):"Entrando na sala...":c?l("join_room"):"Entrar na Sala"})]})]}),_&&(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageError),children:_})]})})}):"waiting"===b&&g?(0,t.jsx)("div",{className:x().container,children:(0,t.jsx)("div",{className:x().content,children:(0,t.jsxs)("div",{className:x().waitingRoom,children:[(0,t.jsx)("h1",{className:x().title,children:c?l("waiting_for_players"):"Aguardando Jogadores"}),(0,t.jsx)("div",{className:x().roomCode,children:p}),(0,t.jsx)("p",{children:"Compartilhe este c\xf3digo com outros jogadores"}),(0,t.jsxs)("div",{className:x().playersList,children:[(0,t.jsxs)("h3",{className:x().playersTitle,children:[c?l("players_in_room"):"Jogadores na sala"," (",(null==g?void 0:null===(r=g.players)||void 0===r?void 0:r.length)||0,")"]}),(null==g?void 0:null===(o=g.players)||void 0===o?void 0:o.map((e,a)=>(0,t.jsxs)("div",{className:x().playerItem,children:[(0,t.jsx)("span",{className:x().playerName,children:e}),e===g.host&&(0,t.jsx)("span",{className:x().hostBadge,children:"ANFITRI\xc3O"})]},"player-".concat(e,"-").concat(a))))||[]]}),R?(0,t.jsxs)("div",{className:x().buttonGroup,children:[(0,t.jsx)("button",{className:x().secondaryButton,onClick:T,disabled:h,children:c?l("leave_room"):"Sair da Sala"}),(0,t.jsx)("button",{className:x().primaryButton,onClick:C,disabled:h||!k,children:c?l("start_game"):"Iniciar Jogo"})]}):(0,t.jsxs)("div",{className:x().buttonGroup,children:[(0,t.jsx)("button",{className:x().secondaryButton,onClick:T,disabled:h,children:c?l("leave_room"):"Sair da Sala"}),(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageInfo),children:c?l("waiting_for_host"):"Aguardando anfitri\xe3o iniciar o jogo..."})]}),!k&&(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageWarning),children:c?l("minimum_players"):"M\xednimo 2 jogadores para iniciar"}),_&&(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageError),children:_})]})})}):(0,t.jsx)("div",{className:x().container,children:(0,t.jsx)("div",{className:x().content,children:(0,t.jsxs)("div",{className:x().loading,children:[(0,t.jsx)("div",{className:x().spinner}),c?l("loading"):"Carregando..."]})})})},_=r(8069),v=r(1716),E=r.n(v),b=r(5928),f=e=>{var a,r,o,n,l,c,d,u,p;let{onBackToLobby:m}=e,{t:g,isClient:h}=(0,s.Z)(),{state:v,actions:f}=y(),{playerNickname:j,lobbyData:N,error:S}=v,[C,T]=(0,i.useState)(""),[R,k]=(0,i.useState)(!1),[O,D]=(0,i.useState)([]),[w,A]=(0,i.useState)(!1),[B,M]=(0,i.useState)(!1),[L,I]=(0,i.useState)(0),[G,P]=(0,i.useState)(1),[z,F]=(0,i.useState)(!1),[Y,J]=(0,i.useState)(0),W=(0,i.useRef)(null),U=(0,i.useRef)(null),H=null==N?void 0:N.gameState,q=null==N?void 0:N.currentSong,V=(null==N?void 0:N.host)===j,Z=(null==H?void 0:H.roundWinners)||[],K=(null==H?void 0:H.roundFinished)||!1,X=null==H?void 0:H.gameFinished,Q=(null==H?void 0:null===(a=H.attempts)||void 0===a?void 0:a[j])||0,$=[.6,1.2,2,3,3.5,4.2],ee=Z.includes(j),ea=q;if(!ea&&(null==H?void 0:H.songs)&&H.songs.length>0){let e=(H.currentRound||1)-1;ea=H.songs[e]}!ea&&(null==H?void 0:H.currentSong)&&(ea=_.songs.find(e=>e.title.trim().toLowerCase()===H.currentSong.trim().toLowerCase()));let er=(e,a)=>31*a%997/997*Math.max(0,e-10);(0,i.useEffect)(()=>{let e=q;if(!e&&(null==H?void 0:H.songs)&&H.songs.length>0){let a=(H.currentRound||1)-1;e=H.songs[a]}if(!e&&(null==H?void 0:H.currentSong)&&(e=_.songs.find(e=>e.title.trim().toLowerCase()===H.currentSong.trim().toLowerCase())),e&&W.current){let a=()=>{let a=er(W.current.duration||0,e.id);J(a),W.current.currentTime=a,I(0)},r=()=>{};return W.current.addEventListener("loadedmetadata",a),W.current.addEventListener("error",r),()=>{W.current&&(W.current.removeEventListener("loadedmetadata",a),W.current.removeEventListener("error",r))}}},[q,null==H?void 0:H.songs,null==H?void 0:H.currentRound,null==H?void 0:H.currentSong]),(0,i.useEffect)(()=>{let e=W.current;if(!e)return;let a=ee?15:$[Q]||$[$.length-1],r=()=>{let r=e.currentTime-Y;r>=15?(e.pause(),M(!1),e.currentTime=Y,I(0)):!ee&&r>=a?(e.pause(),M(!1),e.currentTime=Y,I(0)):I(r)},t=()=>{M(!e.paused)};return e.addEventListener("timeupdate",r),e.addEventListener("play",t),e.addEventListener("pause",t),()=>{e.removeEventListener("timeupdate",r),e.removeEventListener("play",t),e.removeEventListener("pause",t)}},[Y,Q,ee]),(0,i.useEffect)(()=>{W.current&&(W.current.pause(),M(!1),I(0),void 0!==Y&&(W.current.currentTime=Y)),T(""),k(!1),D([]),F(!1)},[null==H?void 0:H.currentRound,Y]),(0,i.useEffect)(()=>{W.current&&(null==ea?void 0:ea.audioUrl)&&(W.current.pause(),M(!1),I(0),W.current.load())},[null==ea?void 0:ea.audioUrl]);let et=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]/g,""),eo=(e,a)=>{let r=et(e.title),t=et(e.game),o=et(e.artist),n=et(a);return r.includes(n)?1:t.includes(n)?2:o.includes(n)?3:4},en=e=>{if(e.length>0){let a=e.trim().split(/\s+/).filter(e=>e.length>0).map(e=>et(e)).filter(e=>e.length>1);if(0===a.length)return D([]),k(!1),[];let r=_.songs.filter(e=>{let r=et(e.title),t=et(e.game),o=et(e.artist);return a.some(e=>r.includes(e)||t.includes(e)||o.includes(e))}).sort((a,r)=>{let t=eo(a,e),o=eo(r,e);if(t!==o)return t-o;let n=et(a.game).localeCompare(et(r.game));return 0!==n?n:et(a.title).localeCompare(et(r.title))}).slice(0,20);D(r),k(r.length>0)}else D([]),k(!1);return[]},es=e=>{T(e.title),k(!1)},ei=async e=>{if(e.preventDefault(),K||!C.trim()||w){F(!0),setTimeout(()=>F(!1),500);return}let a=et(C);if(!_.songs.some(e=>et(e.title)===a)){f.setError(h?g("select_from_list"):"Selecione uma m\xfasica da lista"),F(!0),setTimeout(()=>F(!1),500),setTimeout(()=>f.setError(""),3e3);return}A(!0);let r=await f.makeGuess(C.trim());A(!1),r.success?(T(""),k(!1),r.correct?r.tooLate?(f.setError(r.message||"Algu\xe9m j\xe1 havia acertado primeiro!"),setTimeout(()=>f.setError(""),4e3)):f.setError(""):r.gameCorrect&&(f.setError("Jogo correto! Tente adivinhar a m\xfasica espec\xedfica."),setTimeout(()=>f.setError(""),3e3))):(F(!0),setTimeout(()=>F(!1),500))},el=async()=>{await f.nextRound()},ec=async()=>{await f.skipRound()},ed=(e,a)=>{if(!e||0===a)return null;if(1===a){if(W.current&&W.current.duration){let e=W.current.duration,a="".concat((Math.floor(e/60)||0).toString().padStart(2,"0"),":").concat((Math.floor(e%60)||0).toString().padStart(2,"0"));return"Dura\xe7\xe3o: ".concat(a)}return"Dura\xe7\xe3o: ~3:00"}return 2===a?"Ano de lan\xe7amento: ".concat(e.year):3===a?"Artista: ".concat(e.artist):4===a?"Console: ".concat(e.console||"Desconhecido"):a>=5?"Franquia: ".concat(e.game):null},eu=async()=>{f.reset(),m()},ep=async()=>{await f.resetGame()},em=(null==H?void 0:H.scores)?Object.entries(H.scores).map(e=>{let[a,r]=e;return{player:a,score:r}}).sort((e,a)=>a.score-e.score):[],ey=em.length>0?em[0].score:0,eg=em.filter(e=>e.score===ey);return N&&N.gameStarted&&H?(0,t.jsx)("div",{className:x().container,children:(0,t.jsx)("div",{className:x().content,children:(0,t.jsxs)("div",{className:x().gameContainer,children:[(0,t.jsxs)("div",{className:x().gameHeader,children:[(0,t.jsx)("div",{className:x().roundInfo,children:X?h?g("game_finished"):"Jogo Finalizado!":H.isTiebreaker?h?g("tiebreaker_round"):"Rodada de Desempate":"".concat(h?g("round"):"Rodada"," ").concat(H.currentRound,"/").concat(H.totalRounds)}),(0,t.jsx)("div",{className:x().scoreBoard,children:Object.entries(H.scores||{}).map((e,a)=>{let[r,o]=e;return(0,t.jsxs)("div",{className:"".concat(x().scoreItem," ").concat(r===j?x().currentPlayer:""),children:[r,": ",o]},"".concat(r,"-").concat(a))})})]}),ed(ea,Q)&&!X&&!K&&(0,t.jsxs)("div",{className:x().hintBox,children:[(0,t.jsx)("strong",{children:"Dica:"})," ",ed(ea,Q)]}),X?(0,t.jsxs)("div",{style:{textAlign:"center"},children:[(0,t.jsx)("h2",{children:h?g("final_scores"):"Pontua\xe7\xe3o Final"}),(0,t.jsxs)("div",{className:x().pointsExplanation,children:[(0,t.jsx)("p",{children:"Sistema de Pontua\xe7\xe3o:"}),(0,t.jsx)("p",{children:"6 pontos (sem dicas) • 5 pontos (1 dica) • 4 pontos (2 dicas) • 3 pontos (3 dicas) • 2 pontos (4 dicas) • 1 ponto (5 dicas)"})]}),(0,t.jsx)("div",{style:{margin:"30px 0"},children:em.map((e,a)=>(0,t.jsxs)("div",{className:x().scoreItem,style:{margin:"10px auto",maxWidth:"300px",fontSize:0===a?"1.2rem":"1rem",fontWeight:0===a?"bold":"normal"},children:["#",a+1," ",e.player,": ",e.score," pontos"]},e.player))}),(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageSuccess),children:1===eg.length?"".concat(h?g("winner"):"Vencedor",": ").concat(eg[0].player,"!"):"".concat(h?g("tie"):"Empate","! ").concat(eg.map(e=>e.player).join(", "))}),(0,t.jsxs)("div",{className:x().buttonGroup,children:[(0,t.jsx)("button",{className:x().secondaryButton,onClick:eu,children:h?g("back_to_lobby"):"Voltar ao Lobby"}),V&&(0,t.jsx)("button",{className:x().primaryButton,onClick:ep,children:h?g("play_again"):"Jogar Novamente"})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:E().audioModernBox,children:(0,t.jsxs)("div",{className:E().customAudioPlayer,children:[(0,t.jsxs)("div",{className:E().audioPlayerRow,children:[(0,t.jsx)("span",{className:E().audioTime,children:new Date(1e3*L).toISOString().substring(14,19)}),(0,t.jsx)("input",{type:"range",min:0,max:Math.min(15,ee?15:$[Q]||$[$.length-1]),step:.01,value:L,onChange:e=>{if(W.current&&B){let a=Math.min(Number(e.target.value),15);W.current.currentTime=Y+a,I(a)}},className:E().audioSeekbarCustom,disabled:!ea}),(0,t.jsx)("span",{className:E().audioTime,children:new Date(1e3*Math.min(15,ee?15:$[Q]||$[$.length-1])).toISOString().substring(14,19)})]}),(0,t.jsxs)("div",{className:E().audioVolumeRow,children:[(0,t.jsx)("button",{className:E().audioPlayBtnCustom,onClick:()=>{if(!W.current)return;let e=W.current.currentTime-Y,a=ee?15:$[Q]||$[$.length-1];(e>=15||!ee&&e>=a)&&(W.current.currentTime=Y,I(0)),B?W.current.pause():((W.current.currentTime<Y||W.current.currentTime>Y+a)&&(W.current.currentTime=Y,I(0)),W.current.play().catch(()=>{}))},disabled:!ea,children:B?(0,t.jsx)(b.Wh,{color:"#fff",size:20}):(0,t.jsx)(b.gmG,{color:"#fff",size:20})}),(0,t.jsx)(b.rxG,{color:"#fff",style:{marginRight:8}}),(0,t.jsx)("input",{type:"range",min:0,max:1,step:.01,value:G,onChange:e=>{P(Number(e.target.value)),W.current&&(W.current.volume=Number(e.target.value))},className:E().audioVolumeCustom})]}),(0,t.jsx)("audio",{ref:W,src:null==ea?void 0:ea.audioUrl,style:{display:"none"},onError:()=>f.setError("Erro ao carregar \xe1udio")})]})}),(0,t.jsx)("div",{className:E().pointsInfo,children:(0,t.jsxs)("span",{className:E().pointsText,children:[0===Q?"6 pontos":1===Q?"5 pontos":2===Q?"4 pontos":3===Q?"3 pontos":4===Q?"2 pontos":5===Q?"1 ponto":"0 pontos",Q<6&&" se acertar agora"]})}),(0,t.jsxs)("div",{className:E().attemptsRow,children:[[...Array(6)].map((e,a)=>{var r;let o=E().attemptInactive,n=((null==H?void 0:null===(r=H.guesses)||void 0===r?void 0:r[j])||[])[a];n?n.correct&&!n.tooLate?o=E().attemptSuccess:n.gameCorrect&&!n.correct?o=E().attemptGame:(n.type,o=E().attemptFail):a<Q&&(o=E().attemptFail);let s=n?"skipped"===n.type?"Pulou":n.guess:"";return(0,t.jsx)("button",{type:"button",className:"".concat(E().attemptButton," ").concat(o),disabled:!0,title:s,style:{cursor:s?"help":"default"},children:a+1},a)}),(0,t.jsxs)("button",{type:"button",className:"".concat(E().attemptButton," ").concat(E().attemptInactive),onClick:ec,disabled:K||Q>=6||ee,style:{marginLeft:"10px"},children:[h?g("skip"):"Pular"," ",(0,t.jsx)(b.uE0,{style:{marginLeft:4,fontSize:"1em",verticalAlign:"middle"}})]})]}),!K&&!ee&&(0,t.jsxs)("form",{onSubmit:ei,className:E().guessFormModern,autoComplete:"off",style:{marginTop:"15px"},children:[(0,t.jsx)("input",{ref:U,type:"text",value:C,onChange:e=>{let a=e.target.value;T(a),en(a)},onFocus:()=>{C.trim()?en(C):(D(_.songs.slice(0,8)),k(!0))},placeholder:h?g("song_input_placeholder"):"Digite o nome da m\xfasica...",disabled:Q>=6,className:E().guessInputModern,onBlur:()=>setTimeout(()=>k(!1),200)}),(0,t.jsx)("button",{type:"submit",disabled:Q>=6||!C.trim()||w,className:"".concat(E().guessButtonModern," ").concat(z?E().shake:""),children:w?"Enviando...":h?g("guess"):"Adivinhar"}),R&&O.length>0&&(0,t.jsx)("ul",{className:E().suggestionsListModern,children:O.map((e,a)=>(0,t.jsxs)("li",{className:E().suggestionItemModern,onMouseDown:()=>es(e),children:[e.game," - ",e.title]},"mp-suggestion-".concat(e.id,"-").concat(a)))})]}),Q>=6&&!K&&!ee&&(0,t.jsxs)("div",{className:"".concat(x().message," ").concat(x().messageWarning),style:{marginTop:"15px"},children:[(0,t.jsx)("div",{style:{fontSize:"1rem",marginBottom:"8px"},children:"\uD83D\uDE14 Voc\xea esgotou suas tentativas!"}),(0,t.jsx)("div",{style:{fontSize:"0.9rem",opacity:.8},children:"Aguardando outros jogadores terminarem..."})]}),(null==H?void 0:null===(o=H.guesses)||void 0===o?void 0:null===(r=o[j])||void 0===r?void 0:r.length)>0&&!K&&(0,t.jsxs)("div",{style:{marginTop:"15px"},children:[(0,t.jsx)("div",{style:{marginBottom:"8px",fontSize:"0.85rem",fontWeight:"bold",color:"#4ecdc4",textAlign:"center"},children:"Suas Tentativas"}),(0,t.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"10px",backdropFilter:"blur(10px)",maxHeight:"100px",overflowY:"auto"},children:H.guesses[j].map((e,a)=>(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:a===H.guesses[j].length-1?"0":"6px",padding:"8px 12px",borderRadius:"6px",background:e.correct?"rgba(46, 125, 50, 0.8)":e.gameCorrect?"rgba(245, 124, 0, 0.8)":"skipped"===e.type?"rgba(97, 97, 97, 0.8)":"rgba(198, 40, 40, 0.8)",border:"2px solid ".concat(e.correct?"#4caf50":e.gameCorrect?"#ff9800":"skipped"===e.type?"#757575":"#f44336"),fontSize:"0.9rem"},children:[(0,t.jsxs)("span",{style:{color:"#ffffff",fontWeight:"600",textShadow:"1px 1px 2px rgba(0,0,0,0.7)"},children:[a+1,". ","skipped"===e.type?"Pulou":e.guess]}),(0,t.jsx)("span",{style:{fontSize:"1rem",filter:"drop-shadow(1px 1px 1px rgba(0,0,0,0.8))"},children:e.correct?"✅":e.gameCorrect?"\uD83C\uDFAE":"skipped"===e.type?"⏭️":"❌"})]},"live-guess-".concat(a,"-").concat(e.attempt||a)))})]}),(0,t.jsx)("div",{style:{marginTop:"15px"},children:(0,t.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"8px",padding:"10px",backdropFilter:"blur(10px)",display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"center"},children:null==N?void 0:null===(n=N.players)||void 0===n?void 0:n.map((e,a)=>{var r;let o=(null==H?void 0:null===(r=H.attempts)||void 0===r?void 0:r[e])||0,n=Z.includes(e),s=n||o>=6,i=e===j;return(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",padding:"6px 10px",borderRadius:"6px",background:i?"rgba(78, 205, 196, 0.2)":"rgba(255, 255, 255, 0.05)",border:i?"1px solid rgba(78, 205, 196, 0.4)":"1px solid rgba(255, 255, 255, 0.1)",fontSize:"0.8rem"},children:[(0,t.jsx)("div",{style:{width:"6px",height:"6px",borderRadius:"50%",background:n?"#4caf50":s?"#ff9800":"#2196f3",boxShadow:"0 0 4px ".concat(n?"#4caf50":s?"#ff9800":"#2196f3","50")}}),(0,t.jsx)("span",{style:{color:i?"#4ecdc4":"#fff",fontWeight:i?"bold":"normal"},children:e}),(0,t.jsx)("span",{style:{color:n?"#4caf50":s?"#ff9800":"#ccc",fontSize:"0.75rem"},children:n?"✅":s?"\uD83D\uDE14":"".concat(o,"/6")})]},"compact-player-".concat(e,"-").concat(a))})})}),ee&&!K&&(0,t.jsxs)("div",{className:"".concat(x().message," ").concat(x().messageSuccess),children:[(0,t.jsx)("div",{style:{fontSize:"1.2rem",marginBottom:"10px"},children:"\uD83C\uDF89 Parab\xe9ns! Voc\xea acertou!"}),(0,t.jsx)("div",{style:{fontSize:"1rem",marginBottom:"15px"},children:(0,t.jsxs)("strong",{children:[null==ea?void 0:ea.game," - ",null==ea?void 0:ea.title]})}),(0,t.jsxs)("div",{className:x().pointsEarned,children:["+",Math.max(0,6-Q+1)," pontos!"]}),(0,t.jsx)("div",{style:{marginTop:"15px",fontSize:"0.9rem",opacity:.8},children:"Aguardando outros jogadores terminarem suas tentativas..."}),(0,t.jsxs)("div",{style:{marginTop:"20px"},children:[(0,t.jsx)("div",{style:{marginBottom:"12px",fontSize:"0.9rem",fontWeight:"bold",color:"#4ecdc4",textAlign:"center"},children:"Suas Tentativas"}),(0,t.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"15px",maxHeight:"120px",overflowY:"auto",backdropFilter:"blur(10px)"},children:(null==H?void 0:null===(c=H.guesses)||void 0===c?void 0:null===(l=c[j])||void 0===l?void 0:l.length)>0?H.guesses[j].map((e,a)=>(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"5px",padding:"4px 8px",borderRadius:"4px",background:e.correct?"rgba(76, 175, 80, 0.2)":e.gameCorrect?"rgba(255, 193, 7, 0.2)":"skipped"===e.type?"rgba(158, 158, 158, 0.2)":"rgba(244, 67, 54, 0.2)",border:"1px solid ".concat(e.correct?"rgba(76, 175, 80, 0.4)":e.gameCorrect?"rgba(255, 193, 7, 0.4)":"skipped"===e.type?"rgba(158, 158, 158, 0.4)":"rgba(244, 67, 54, 0.4)")},children:[(0,t.jsx)("span",{style:{color:e.correct?"#4caf50":e.gameCorrect?"#ffc107":"skipped"===e.type?"#9e9e9e":"#f44336"},children:"skipped"===e.type?"⏭️ Pulou":e.guess}),(0,t.jsx)("span",{style:{fontSize:"0.75rem",opacity:.8},children:e.correct?"✅":e.gameCorrect?"\uD83C\uDFAE":"skipped"===e.type?"⏭️":"❌"})]},"guess-".concat(a,"-").concat(e.attempt||a))):(0,t.jsx)("div",{style:{textAlign:"center",opacity:.6},children:"Nenhuma tentativa ainda"})})]}),(0,t.jsxs)("div",{style:{marginTop:"20px"},children:[(0,t.jsx)("div",{style:{marginBottom:"12px",fontSize:"0.9rem",fontWeight:"bold",color:"#4ecdc4",textAlign:"center"},children:"Status dos Jogadores"}),(0,t.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"15px",backdropFilter:"blur(10px)"},children:null==N?void 0:null===(d=N.players)||void 0===d?void 0:d.map((e,a)=>{var r;let o=(null==H?void 0:null===(r=H.attempts)||void 0===r?void 0:r[e])||0,n=Z.includes(e),s=n||o>=6,i=e===j;return(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:a===N.players.length-1?"0":"10px",padding:"12px 16px",borderRadius:"8px",background:i?"rgba(78, 205, 196, 0.15)":"rgba(255, 255, 255, 0.03)",border:i?"1px solid rgba(78, 205, 196, 0.3)":"1px solid rgba(255, 255, 255, 0.05)",transition:"all 0.3s ease"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,t.jsx)("div",{style:{width:"8px",height:"8px",borderRadius:"50%",background:n?"#4caf50":s?"#ff9800":"#2196f3",boxShadow:"0 0 8px ".concat(n?"#4caf50":s?"#ff9800":"#2196f3","50")}}),(0,t.jsxs)("span",{style:{fontWeight:i?"bold":"normal",color:i?"#4ecdc4":"#fff",fontSize:"0.9rem"},children:[e,i&&(0,t.jsx)("span",{style:{fontSize:"0.7rem",opacity:.7,marginLeft:"6px"},children:"(voc\xea)"})]})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,t.jsx)("span",{style:{fontSize:"0.8rem",color:n?"#4caf50":s?"#ff9800":"#ccc",fontWeight:"500"},children:n?"Acertou":s?"Terminou":"".concat(o,"/6")}),(0,t.jsx)("span",{style:{fontSize:"1rem"},children:n?"\uD83C\uDF89":s?"\uD83D\uDE14":"\uD83C\uDFAE"})]})]},"player-status-".concat(e,"-").concat(a))})})]})]}),K&&(0,t.jsxs)("div",{className:"".concat(x().message," ").concat(Z.includes("NONE")?x().messageWarning:x().messageSuccess),children:[Z.includes("NONE")?h?g("no_one_guessed"):"Ningu\xe9m acertou a m\xfasica!":1===Z.length?Z[0]===j?h?g("congratulations"):"Parab\xe9ns! Voc\xea acertou!":"".concat(Z[0]," ").concat(h?g("player_guessed_correctly"):"acertou a m\xfasica!"):Z.length===N.players.length?"Todos acertaram!":"".concat(Z.length," jogadores acertaram: ").concat(Z.join(", ")),(0,t.jsx)("br",{}),(0,t.jsxs)("strong",{children:[null==ea?void 0:ea.game," - ",null==ea?void 0:ea.title]}),ee&&(0,t.jsxs)("div",{className:x().pointsEarned,children:["+",Math.max(0,6-Q+1)," pontos!"]}),(null==H?void 0:null===(p=H.guesses)||void 0===p?void 0:null===(u=p[j])||void 0===u?void 0:u.length)>0&&(0,t.jsxs)("div",{style:{marginTop:"20px"},children:[(0,t.jsx)("div",{style:{marginBottom:"12px",fontSize:"0.9rem",fontWeight:"bold",color:"#4ecdc4",textAlign:"center"},children:"Suas Tentativas desta Rodada"}),(0,t.jsx)("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"15px",maxHeight:"120px",overflowY:"auto",backdropFilter:"blur(10px)"},children:H.guesses[j].map((e,a)=>(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"4px",padding:"3px 6px",borderRadius:"3px",background:e.correct?"rgba(76, 175, 80, 0.2)":e.gameCorrect?"rgba(255, 193, 7, 0.2)":"skipped"===e.type?"rgba(158, 158, 158, 0.2)":"rgba(244, 67, 54, 0.2)",fontSize:"0.8rem"},children:[(0,t.jsxs)("span",{style:{color:e.correct?"#4caf50":e.gameCorrect?"#ffc107":"skipped"===e.type?"#9e9e9e":"#f44336"},children:[a+1,". ","skipped"===e.type?"Pulou":e.guess]}),(0,t.jsx)("span",{style:{fontSize:"0.7rem"},children:e.correct?"✅":e.gameCorrect?"\uD83C\uDFAE":"skipped"===e.type?"⏭️":"❌"})]},"final-guess-".concat(a,"-").concat(e.attempt||a)))})]})]}),K&&V&&(0,t.jsx)("div",{style:{textAlign:"center",marginTop:"20px"},children:(0,t.jsx)("button",{className:x().primaryButton,onClick:el,children:h?g("next_round"):"Pr\xf3xima Rodada"})}),K&&!V&&(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageInfo),children:"Aguardando anfitri\xe3o avan\xe7ar para a pr\xf3xima rodada..."})]}),S&&(0,t.jsx)("div",{className:"".concat(x().message," ").concat(x().messageError),children:S})]})})}):(0,t.jsx)("div",{className:x().container,children:(0,t.jsx)("div",{className:x().content,children:(0,t.jsxs)("div",{className:x().loading,children:[(0,t.jsx)("div",{className:x().spinner}),h?g("loading"):"Carregando..."]})})})},j=r(1775);function N(){let{t:e,isClient:a}=(0,s.Z)(),{state:r,actions:o}=y();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n(),{children:[(0,t.jsx)("title",{children:a?"".concat(e("multiplayer")," - Bandle"):"Multiplayer - Bandle"}),(0,t.jsx)("meta",{name:"description",content:a?"Jogue Bandle com seus amigos! Adivinhe m\xfasicas de videogames em modo multiplayer.":"Play Bandle with your friends! Guess video game music in multiplayer mode."}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh"},children:[(0,t.jsx)("div",{style:{flex:1},children:"lobby"===r.currentScreen?(0,t.jsx)(h,{onGameStart:()=>{o.setCurrentScreen("game")}}):(0,t.jsx)(f,{onBackToLobby:()=>{o.setCurrentScreen("lobby")}})}),(0,t.jsx)(j.Z,{})]})]})}function S(){return(0,t.jsx)(m,{children:(0,t.jsx)(N,{})})}},7696:function(e){e.exports={container:"Multiplayer_container__pG5zq",content:"Multiplayer_content__paqrY",lobbyContainer:"Multiplayer_lobbyContainer__mFUxx",title:"Multiplayer_title__c2wel",buttonGroup:"Multiplayer_buttonGroup__MtTI1",primaryButton:"Multiplayer_primaryButton__5Qr0G",secondaryButton:"Multiplayer_secondaryButton__fOHZA",form:"Multiplayer_form__NEyLG",inputGroup:"Multiplayer_inputGroup__xUkyP",label:"Multiplayer_label__JdhkF",input:"Multiplayer_input__d_6vv",waitingRoom:"Multiplayer_waitingRoom__TnsCI",roomCode:"Multiplayer_roomCode__xMu8X",playersList:"Multiplayer_playersList__JTt5d",playersTitle:"Multiplayer_playersTitle__GDwhB",playerItem:"Multiplayer_playerItem__ueGdP",playerName:"Multiplayer_playerName__98Zrf",hostBadge:"Multiplayer_hostBadge__XJkEC",gameContainer:"Multiplayer_gameContainer__BNvB0",gameHeader:"Multiplayer_gameHeader__zIa0f",roundInfo:"Multiplayer_roundInfo__29inF",scoreBoard:"Multiplayer_scoreBoard__RE7qE",scoreItem:"Multiplayer_scoreItem__LDz9_",currentPlayer:"Multiplayer_currentPlayer__Bc1B2",pointsInfo:"Multiplayer_pointsInfo___JMag",pointsText:"Multiplayer_pointsText__wVJq1",pointsExplanation:"Multiplayer_pointsExplanation__pVq8O",pointsEarned:"Multiplayer_pointsEarned__8c11S",hintBox:"Multiplayer_hintBox__Gctzd",message:"Multiplayer_message__O7bg0",messageSuccess:"Multiplayer_messageSuccess__X0lOU",messageError:"Multiplayer_messageError__Dhxdu",messageInfo:"Multiplayer_messageInfo__86_jG",messageWarning:"Multiplayer_messageWarning__ei_9w",loading:"Multiplayer_loading__U_sZC",spinner:"Multiplayer_spinner__kPnfW",spin:"Multiplayer_spin__sGivk"}},8038:function(e,a,r){e.exports=r(9794)}},function(e){e.O(0,[703,72,333,888,774,179],function(){return e(e.s=683)}),_N_E=e.O()}]);